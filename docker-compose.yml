services:
  ib-gateway:
    image: gnzsnz/ib-gateway:stable
    container_name: ib-gateway
    restart: unless-stopped
    environment:
      - TWS_USERID=${IB_USERNAME}
      - TWS_PASSWORD=${IB_PASSWORD}
      - TRADING_MODE=paper
      - JAVA_HEAP_SIZE=2048
      - VNC_SERVER_PASSWORD=${VNC_PASSWORD:-changeme}
    ports:
      - "4001:4001"
      - "4002:4002"
      - "5900:5900"

  bot:
    build: .
    container_name: autoscalper
    restart: unless-stopped
    network_mode: host
    env_file:
      - .env
    environment:
      - IBKR_HOST=127.0.0.1
      - IBKR_PORT=4002
    volumes:
      - ./logs:/app/logs
    depends_on:
      - ib-gateway
